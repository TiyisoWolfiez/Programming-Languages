       IDENTIFICATION DIVISION.
       PROGRAM-ID. Statistics.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
       *> cobc -x -free -o Statistics Statistics.cob ./Statistics
           SELECT STANDARD-INPUT ASSIGN TO KEYBOARD.
           SELECT STANDARD-OUTPUT ASSIGN TO DISPLAY.

       DATA DIVISION.
       FILE SECTION.
       FD  STANDARD-INPUT.
       01  STANDARD-INPUT-REC.
           05  STANDARD-INPUT-VALUE  PIC X.

       FD  STANDARD-OUTPUT.
       01  STANDARD-OUTPUT-REC.
           05  STANDARD-OUTPUT-VALUE  PIC X.

       WORKING-STORAGE SECTION.
       01  ARRAY-SIZE                 PIC 9 VALUE 5.
       01  ARRAY-ELEMENTS             PIC 9(3) OCCURS 8 TIMES.
       01  ARRAY-ELEMENT-INDEX        PIC 9 VALUE 1.
       01  SMALLEST-VALUE             PIC 9.
       01  LARGEST-VALUE              PIC 9.
       01  MODE-VALUE                 PIC 9.
       01  ELEMENT-COUNT-TABLE.
           05  ELEMENT-COUNT          PIC 9(5) OCCURS 0 TO 99999 TIMES
                                 DEPENDING ON ARRAY-SIZE.

       PROCEDURE DIVISION.
       MAIN-PROCEDURE.
           PERFORM READ-ARRAY-DATA.
           PERFORM FIND-SMALLEST-VALUE.
           PERFORM FIND-LARGEST-VALUE.
           PERFORM FIND-MODE-VALUE.
           PERFORM DISPLAY-RESULTS.
           STOP RUN.

       READ-ARRAY-DATA.
           DISPLAY "Enter five integer values:".
           PERFORM VARYING ARRAY-ELEMENT-INDEX FROM 1 BY 1
                   UNTIL ARRAY-ELEMENT-INDEX > ARRAY-SIZE
               DISPLAY "Enter value " ARRAY-ELEMENT-INDEX ": "
                   WITH NO ADVANCING
               ACCEPT ARRAY-ELEMENTS(ARRAY-ELEMENT-INDEX)
           END-PERFORM.

       FIND-SMALLEST-VALUE.
           MOVE ARRAY-ELEMENTS(1) TO SMALLEST-VALUE.
           PERFORM VARYING ARRAY-ELEMENT-INDEX FROM 2 BY 1
                   UNTIL ARRAY-ELEMENT-INDEX > ARRAY-SIZE
               IF ARRAY-ELEMENTS(ARRAY-ELEMENT-INDEX) < SMALLEST-VALUE
                   MOVE ARRAY-ELEMENTS(ARRAY-ELEMENT-INDEX)
                       TO SMALLEST-VALUE
               END-IF
           END-PERFORM.

       FIND-LARGEST-VALUE.
           MOVE ARRAY-ELEMENTS(1) TO LARGEST-VALUE.
           PERFORM VARYING ARRAY-ELEMENT-INDEX FROM 2 BY 1
                   UNTIL ARRAY-ELEMENT-INDEX > ARRAY-SIZE
               IF ARRAY-ELEMENTS(ARRAY-ELEMENT-INDEX) > LARGEST-VALUE
                   MOVE ARRAY-ELEMENTS(ARRAY-ELEMENT-INDEX)
                       TO LARGEST-VALUE
               END-IF
           END-PERFORM.

       FIND-MODE-VALUE.
           INITIALIZE ELEMENT-COUNT-TABLE.
           PERFORM VARYING ARRAY-ELEMENT-INDEX FROM 1 BY 1
                   UNTIL ARRAY-ELEMENT-INDEX > ARRAY-SIZE
               ADD 1 TO ELEMENT-COUNT(ARRAY-ELEMENTS(ARRAY-ELEMENT-INDEX))
           END-PERFORM.

           MOVE ARRAY-ELEMENTS(1) TO MODE-VALUE.
           MOVE ELEMENT-COUNT(ARRAY-ELEMENTS(1)) TO ARRAY-ELEMENT-INDEX.
           PERFORM VARYING ARRAY-ELEMENT-INDEX FROM 2 BY 1
                   UNTIL ARRAY-ELEMENT-INDEX > ARRAY-SIZE
               IF ELEMENT-COUNT(ARRAY-ELEMENTS(ARRAY-ELEMENT-INDEX))
                   > ELEMENT-COUNT(ARRAY-ELEMENTS(1))
                   MOVE ARRAY-ELEMENTS(ARRAY-ELEMENT-INDEX) TO MODE-VALUE
               END-IF
           END-PERFORM.
       DISPLAY-RESULTS.
           DISPLAY "Smallest value: " SMALLEST-VALUE.
           DISPLAY "Largest value: " LARGEST-VALUE.
           DISPLAY "Mode: " MODE-VALUE.
      
